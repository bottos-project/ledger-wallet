### 说明

ledger nanos 是一个硬件钱包, 它提供了一个平台可以编写应用程序,  应用程序和其他设备通过APDU协议进行通讯。
此项协议主要用在智能卡和读写器之间。

作为硬件钱包最重要的功能就是可以提供高度隐私的私钥和对数据进行签名。 所以在其上编写的APP 至少应该拥有下面两个功能。

* 提供获取HD的公钥   getPublickKey

* 提供对数据进行签名 signHash


#### 通信协议格式

请求APDU指令

| 字段名 | 字节长度 | 说明 |
| ------ | ------ | ------ |
| CLA | 1 | 指令类型 |
| INS | 1 | 指令代码 |
| P1,P2 | 2 |指令参数 |
| P3 | 0/1/2/3 |携带的数据长度(N) |
| Command data | N |
| Le | 0/1/2/3 |期待相应的最大数据长度 |


响应APDU指令

| 字段名 | 字节长度 | 说明 |
| ------ | ------ | ------ |
| resp data | N | 响应数据 |
| SW1-SW2 | 2 | APDU命令状态  |


#### getPublicKey  

> 功能 : 获取硬件钱包的公钥
由于ledgaerHQ 支持HD钱包 并且满足BIP44协议规范 因此我们需要传递的参数为正确的HD钱包格式


| 字段名 | 内容 | 说明 |
| ------ | ------ | ------ |
| CLA | ea | 定义我们的CLA为ea |
| INS | 01 | 01表示获取公钥|
| P1,P2 | 01/00, 00 |P1的01表示是否需要用户确认 |
| P3 | N |HD路经长度 不超过|
| Command data | N |
| Le | 0/1/2/3 |期待相应的最大数据长度 |

示例:
```shell
getPublicKey   "44'/19724'/0'/0/0"
```

响应APDU指令

| 字段名 | 字节 | 说明 |
| ------ | ------ | ------ |
| resp data |4e5a62355.... | 返回公钥|
| SW1-SW2 | 9000 | APDU处理成功  |


#### signHash  

> 功能 : 对hash值进行签名

| 字段名 | 内容 | 说明 |
| ------ | ------ | ------ |
| CLA | ea | 定义我们的CLA为ea |
| INS | 02 | 02表示获取签名|
| P1,P2 | 01, 00 |P1的01表示需要用户确认 |
| P3 | 0x34 |命令数据长度|
| Command data | N |

示例:
```shell
signHash   "44'/19724'/0'/0/0"  sha256
```

响应APDU指令

| 字段名 | 字节 | 说明 |
| ------ | ------ | ------ |
| resp data |435262355.... | 返回签名格式为(V|R|S)|
| SW1-SW2 | 9000 | APDU处理成功  |